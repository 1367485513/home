---
layout: default
---

# RISC-V 双周简报 (2017-08-31)

## RV新闻

### RISC-V并入newlib主线
newlib 的 risc-v port 已经被正式合并。详情可见[https://goo.gl/37oeZG](https://groups.google.com/a/groups.riscv.org/forum/#!msg/sw-dev/XLO_iHwEfCU/XaeGX6RyAAAJ)。

### FreeBSD 主线更新至 RISC-V priv. spec 1.10 
最近，FreeBSD更新至 RISC-V priv. spec 1.10，现在支持Spike和Rocket-chip。详情可以参考这裡：[https://wiki.freebsd.org/riscv](https://wiki.freebsd.org/riscv)和[https://svnweb.freebsd.org/base?view=revision&revision=322361](https://svnweb.freebsd.org/base?view=revision&revision=322361)

另外11月的BSDTW, 也会有两个关于RISC-V的报告。Ruslan、Arun 和 EdMaste都会出席，有兴趣的可以参加。

### RISC-V LLVM进度更新

Alex Bradbury在[https://github.com/lowRISC/riscv-llvm/issues](https://github.com/lowRISC/riscv-llvm/issues)
上发布了一系列的LLVM子工程，以便更多的人参与到RISC-V的LLVM支持工作中。

当前正在进行的是让LLVM支持RV32I，相关的补丁已经送到LLVM社区进行审议，其中7个已经被接受，8个正在征求意见。
正在开发中的RISC-V LLVM现在已经通关过了1352个GCC测试集中的1315个，未能通过的测试例子中32个编译时错误，5个运行时错误。

具体信息请参考Alex的邮件：[https://goo.gl/sGeWcy](https://groups.google.com/a/groups.riscv.org/forum/#!msg/sw-dev/hMB8RKLFYrw/Xsp6hPxWDQAJ)

### SiFive发布TileLink说明文档 v1.7

此次发布的分档比较详细地介绍了当前被使用于Rocke-Chip的第二版TileLink片上总线。
TileLink片上总线是Rocke-Chip用于连接各级缓存和外设的总线，相比AMBA, Wishbone, Avalon, CoreConnect等等片上总线，TileLink直接在总线协议的层面上支持缓存一致性的各种操作，是基于缓存的各种要求而重新设计的片上总线。
相比TileLink第一版，第二版有以下几点改进：
- 为支持不使用缓存的外设而重新设计报文格式和分配通道。
- 为将来主从设备之间互相发起读写请求提供支持（现在还一般是主设备发出请求从设备被动应答）。
- 使用diplomacy库和scala的延迟求值机制实现编译时总线参数自动配置，解决了一代总线时手动配置经常出现的报文丢失问题。

具体信息请参见说明文档：[https://www.sifive.com/documentation/tilelink/tilelink-spec/](https://www.sifive.com/documentation/tilelink/tilelink-spec/)

### DRAPER分离其安全处理器研究组成立Dover Microsystems公司

Dover的产生来源于美国国防部国防高等研究计划(DARPA)下的[CRASH](https://www.darpa.mil/program/clean-slate-design-of-resilient-adaptive-secure-hosts)(Clean-Slate Re-design of Adaptive, Secure Hosts)计划。
该计划致力于回答一个问题：如果我们能抛开现有计算机体系结构的研究成果，重新设计一个本质上就安全的计算机，我们该怎么做？
基于这个问题，世界上的多个研究小组开展了多年的研究，提出了多种新的计算机架构。
其中源自于MIT的DRAPER实验室设计了Inherently Secure Processor(ISP)。
现在，DRAPER将ISP分离出来，成立了新的Dover Microsystems公司，用ISP来服务于商业应用。
Dover最新的Dover芯片在开源RISC-V处理器内部添加了一个协处理器来加强处理器的安全特性（小编注：该协处理器使用tagged memory进行同步的meta-data processing）。

> The Inherently Secure Processor can be implemented with any Reduced Instruction Set Computer (RISC) processor and is currently optimized for the latest generation RISC-V architecture as a co-processor solution. It can be easily customized for individual customer’s embedded systems, and features adaptable and updatable technology, providing customers with longevity and resiliency into the future.
>
> [http://www.prweb.com/releases/2017/08/prweb14603204.htm](http://www.prweb.com/releases/2017/08/prweb14603204.htm)

#### DRAPER ISP [http://www.draper.com/solution/inherently-secure-processor](http://www.draper.com/solution/inherently-secure-processor)
#### Dover Microsystems [https://dovermicrosystems.com](https://dovermicrosystems.com)

## 技术讨论

### 到底riscv\*\*-unknown-elf是不是bare-metal的交叉编译器？

估计大多数人和我一样都觉得，难道不是吗？嗯，还真不一定是。
[GNU MCU Eclipse RISC-V Embdedded GCC](https://gnu-mcu-eclipse.github.io/)的作者Liviu Ionescu最近就提出了这么个问题，然后引起了激烈的讨论。
看起来，现在RISC-V提供的两个GCC工具链其实是这个样子的：

- **riscv\*\*-unknown-linux-gnu** 是针对Linux操作系统的编译器，会链接glibc，利用Linux系统调用和相应应用接口(ABI)完成底层工作。
- **riscv\*\*-unknown-elf** 是针对嵌入式系统的编译器，使用newlib的C库，不针对具体操作系统，利用libgloss定义的应用接口(ABI)完成底层操作。现在libgloss借用了Linux的ABI，所以使用riscv\*\*-unknown-elf编译的程序有可能也能正常运行于RISC-V Linux中。

如果某一个嵌入式平台需要实现自己的底层调用，现在的办法一般是替换底层的ABI实现，但保留由libgloss定义的接口。
如果希望进一步连ABI都彻底抛弃而直接调用硬件，现在只能通过附加的gcc参数来实现，比如`-nostdlib -lc` (不使用标准库但是用libc)。

为了提供针对最基础嵌入式平台的bare-metal环境，SiFive的Palmer Dabbelt现已着手提供一个新的gcc工具链，暂且命名为**riscv\*\*-unknown-none**。

相关讨论：
#### Liviu Ionescu的问题 [https://goo.gl/VMBSPe](https://groups.google.com/a/groups.riscv.org/forum/#!msg/sw-dev/m_VQUQV_qw0/PA-TCzwDAQAJ)
#### Palmer Dabbelt的回答 [https://goo.gl/bc8zSu](https://groups.google.com/a/groups.riscv.org/forum/#!msg/sw-dev/8szTggvdi48/q8kOlY1AAgAJ)
#### 新工具链 [https://goo.gl/nD9HJD](https://groups.google.com/a/groups.riscv.org/forum/#!msg/sw-dev/8szTggvdi48/q8kOlY1AAgAJ)

### 关于多核缓存一致性具体实现的讨论

[sxu55](https://github.com/sxu55)最近向lowRISC提出一个问题，认为lowRISC所使用的L2实现存在死锁。
在多核系统中，假设一个L2为了回写缓存块A而询问所有L1，同时一个核正在回写缓存块B，并且A和B属于同一个set，有可能由于互相等待造成死锁。
这里的关键问题就是在缓存一致控制器的具体实现时，所有的缓存操作都不再是书本上原子操作，而被拆分成多个子步骤的操作序列。
如果两个操作序列发生交织，则可能造成死锁或数据丢失。最后讨论的结果是这个死锁的条件是不成立的，lowRISC的L2考虑到了这个具体的死锁状况。
不过相关的讨论还是很有意义的，特别是关于基于TileLink的一致性L2的实现。

具体信息请查阅lowRISC issue \#67 [https://git.io/v5YAb](https://github.com/lowRISC/lowrisc-chip/issues/67)

## 代码更新

### Chisel/FIRRTL 即将支持完整的无连接端口清理和跨边界常数优化

为了代码的可读性，我们一般会在硬件设计中保留可选端口和常熟定义，将相关的优化扔给综合软件完成。
Chisel/FIRRTL将更高抽象级别的Chisel转化为Verilog的同时，也可以做相关优化。
Chisel/FIRRTL已经默认去除无连接的端口。最新的FIRRTL也已经开始支持关于常熟的跨模块边界优化。

具体信息请查阅
#### FIRRTL PR \#633 [https://git.io/v5nIt](https://github.com/freechipsproject/firrtl/pull/633)
#### Rocket-chip PR \#968 [https://git.io/v5nIc](https://github.com/freechipsproject/rocket-chip/pull/968)
#### FIRRTL issue \#644 [https://git.io/v5nIR](https://github.com/freechipsproject/firrtl/issues/644)


## 安全点评


## 微群热点


## 实用资料


## 行业视角
	

## 市场相关

### Codasip发佈新的 RISC-V 处理器IP Bk-1
连接：[https://www.codasip.com/2017/08/21/codasip-announces-latest-risc-v-processor/](https://www.codasip.com/2017/08/21/codasip-announces-latest-risc-v-processor/)

## 暴走事件

### 九月

+ ORConf 2017会议将于9月8-10日于英国Hebden Bridge举行。会议网站：[https://orconf.org/](https://orconf.org/)
+ The 7th RISC-V workshop投稿截止日期：2017年9月17日。投稿网站：[https://www.softconf.com/h/riscv7thwkshp/](https://www.softconf.com/h/riscv7thwkshp/)

### 十月

+ [OSDT开源开发工具大会2017](http://www.hellogcc.org/?p=34315)（也就是原HelloGCC会议）将在10月下旬在北京举办，话题和赞助征集已经开始。话题内容包括“面向RISCV等新硬件的基础软件支持”，各位不要错过。
+ [开源经济学研究-2017年年会邀请函](http://www.open-source-economics.org/open_source_economics_2017.html)
+ RISC-V at the [Linley Processor Conference](http://www.linleygroup.com/events/event.php?num=43), 4-5 October 2017 at Santa Clara, California.
+ [First Workshop on Computer Architecture Research with RISC-V (CARRV 2017)](https://carrv.github.io/#first-workshop-on-computer-architecture-research-with-risc-v-carrv-2017), 14 October at Boston, Massachusetts, co-located with MICRO 2017.

### 十一月

+ [The 7th RISC-V workshop](https://www.softconf.com/h/riscv7thwkshp/) 2017年11月28-30日，第7届RISC-V研讨会将在美国加州Milpitas由西部数据承办。
+ [BSDTW17](https://bsdtw.org/) 2017年11月11-12日，BSDTW17会有两场关于RISC-V的演讲，地点在台北。

## 招聘简讯

_CNRV提供为行业公司提供公益性质的一句话的招聘信息发布，若有任何体系结构、IC设计、软件开发的招聘信息，欢迎联系我们！_

----

整理编集: 宋威，郭雄飞，黄柏玮

贡献者：

----

**欢迎关注微信公众号CNRV，接收最新最时尚的RISC-V讯息！**

![CNRV微信公众号](/assets/images/cnrv_qr.png)

----

<a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/cn/"><img alt="知识共享许可协议" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-sa/3.0/cn/80x15.png" /></a><br />本作品采用<a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/cn/">知识共享署名-非商业性使用-相同方式共享 3.0 中国大陆许可协议</a>进行许可。
