---
layout: default
---

# RISC-V 双周简报 (2018-01-04)

要点新闻：


## RV新闻


## 技术讨论



## 代码更新

## 安全点评

## 微群热点

## 实用资料

### Linux kernel Upstream的内容（Palmer 的 All Aboard, Part 8: The RISC-V Linux Port is Upstream!）

Palmer在这篇中记录了 4.15中 Upstream的内容，同时也讲了哪些还需要加强。还需要加强的部分包括memory model、PLIC、DMA、timer、device tree文档、以及SBI console driver。想了解Linux kernel整体的情况的话，可以参考。想了解更多更新，也可以追踪 patches@groups.riscv.org。

连结：[All aboard part 8 ](https://www.sifive.com/blog/2017/12/05/all-aboard-part-8-the-risc-v-linux-port-is-upstream/)


### Palmer 的 All Aboard, Part 9: Paging and the MMU in the RISC-V Linux Kernel

前半段Palmer先介绍了 RISC-V 系统中的 AEE (Application Execution Environment)和 SEE (Supervisor Execution Environment)。在RISC-V中，AEE的部分基本要求包括(小编：scall在2.1中其实已经被更名为ecall)：

> The ISA string, which determines what the vast majority of instructions do as well as which registers constitute the machine’s current state.
> 
> The supervisor’s user-visible ABI, which determines what the scall instruction does. This is different than the C compiler’s ABI, which defines the interface between different components of the application.
> 
> The contents of the entire memory address space.

当然，实际上AEE还是要看各操作系统决定的，譬如FreeBSD 和 Linux的AEE就不同。至于Unix-class 的 SEE，则是会由Platform spec 小组订出一些基本要求，Palmer所猜测的定义如下(除了PMA和SBI以外，这跟workshop时小编记录的类似）：

> Either the RV32I or RV64I base ISAs, along with the M, A, and C extensions. The F and D extensions are optional but paired together, leaving the possible standard ISAs for application-class SEEs as RV32IMAC, RV32IMAFDC (RV32GC), RV64IMAC, and RV64IMAFDC (RV64GC).
> 
> On RV32I-based systems, support for Sv32 page-based virtual memory.
> 
> On RV64I-based systems, support for at least Sv48 page-based virtual memory.
> 
> Upon entering the SEE, the PMAs are set such that memory accesses are point-to-point strongly ordered between harts and devices.
> 
> An SBI that implements various fences, timers, and a console.

在介绍完AEE和SEE这些系统基本的要求后，Palmer整理了一些risc-v中 page table的特点：
> Pages are 4KiB at the leaf node, and it’s possible to map large contiguous regions with every level of the page table.
> 
> RV32I-based systems can have up to 34-bit physical addresses with a three level page table.
> 
> RV64I-based systems can have multiple virtual address widths, starting with 39-bit and extending up to 64-bit in increments of 9 bits.
> 
> Mappings must be synchronized via the sfence.vma instruction.
> 
> There are bits for global mappings, supervisor-only, read/write/execute, and accessed/dirty.
> 
> There is a single valid bit, which allows storing XLEN-1 bits of flags in an otherwise unused page tables. Additionally, there are two bits of software flags in mapped pages.
> 
> Address space identifiers are 9 bits or RV32I and 16 bits on RV64I, and they’re a hint so a valid implementation is to ignore them.
> 
> The accessed and dirty bits are strongly ordered with respect to accesses from the same hart, but are optional (with a trap-based mechanism when unsupported)
> 

值得注意的是，像ASID这种额外功能在risc-v的 Linux kernel中其实还没实作。有兴趣的同学可以把握机会。最后，Palmer介绍了跟device 和DMA有关的部分。因为risc-v 没有定义IOMMU，目前risc-v linux kernel 使用 bounce buffer 及 32bit ZOME_DMA 来处理 device addressing的问题。

更多细节可以参考: [Palmer 的 All aboard part 9](https://www.sifive.com/blog/2017/12/11/all-aboard-part-9-paging-and-mmu-in-risc-v-linux-kernel/)

### Sodor 的设计文档
Shimomura Shigeki 整理了一份约20页的Sodor design doc，详细整理了code structure和每一个档的作用。有在用sodor研究risc-v，或想学chisel的可以参考。

连结：[Sodor design doc](https://docs.google.com/document/d/1WPQblOoKIODLrIacFSumXR6_uC9zquyixNFN8ABVQxY/edit?usp=sharing)

### 另一个chisel的学习资料：Berkeley 的 Generator Bootcamp
想透过学chisel学习rocket和BOOM的同学可以参考这个新的repo。这个 repo 用 Jupyter Notebook 来教怎么用chisel写generator。另外，chisel learning journey 的文档也在不断更新，也可以参考或加入chisel learning journey的hangout。

连结1：[Generator Bootcamp](https://github.com/ucb-bar/generator-bootcamp)

连结2: [chisel learning journey的更新](https://github.com/librecores/riscv-sodor/wiki)



## 行业视角

## 市场相关


## CNRV社区活动

## CNRV网站更新


## 暴走事件



### 二月

+ [FOSDEM'18](https://fosdem.org/2018/) 2018年2月3-4日，FOSDEM (Free and Open Source Developers’ European Meeting)将在比利时的布鲁塞尔举行。

+ [PULP WORKSHOP AT HPCA2018](http://pulp-platform.org/hpca2018) 2018年2月25日，在维也纳的HPCA中，会有一场跟Pulp 有关的workshop。PULP小组会介绍PULP最新的发展，和他们未来的走向，包括  PULP-CAPI (Coherent Accelerator Processor Interface) 和 Ariane （Next generation of 64-bit RISC-V implementations）等。详情可参考 pulpino mailing list 中的 < PULP newsletter - 4Q2017 >。


## 招聘简讯

_CNRV提供为行业公司提供公益性质的一句话的招聘信息发布，若有任何体系结构、IC设计、软件开发的招聘信息，欢迎联系我们！_

----

整理编集: 宋威、黄柏玮、郭雄飞


----

**欢迎关注微信公众号CNRV，接收最新最时尚的RISC-V讯息！**

![CNRV微信公众号](/assets/images/cnrv_qr.png)

----

<a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/cn/"><img alt="知识共享许可协议" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-sa/3.0/cn/80x15.png" /></a><br />本作品采用<a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/cn/">知识共享署名-非商业性使用-相同方式共享 3.0 中国大陆许可协议</a>进行许可。

