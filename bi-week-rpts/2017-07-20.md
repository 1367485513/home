---
layout: default
---

# RISC-V 双周简报 (2017-07-20)

*draft*

## RV新闻

### Syntacore的SCR1处理器更新至Privileged Spec 1.10和User Spec 2.2

On 16/07/2017 08:26, [Alexander Redkin](alexander.redkin@syntacore.com) wrote:
> Dear all,
>
> Our open-source RISC-V RV32I[MC] SCR1 implementation is updated to comply
> with the current draft of the 1.10 privileged spec:
> https://github.com/syntacore/scr1
>
> It's distributed under permissive apache 2.0-based license and we encourage
> academic/educational use (can expect best-effort support).
>
> Feel free to refer to the talk by one of the SCR1 developers at the recent
> 6th RISC-V workshop for additional details:
> https://riscv.org/2017/05/6th-risc-v-workshop-proceedings
>
> Best Regards,
> Alexander 
>

### SiFive的双月新闻

[The SiFive Download](http://sifive-3020607.hs-sites.com/welcome-the-sifive-download-1)

Something concrete here.

## 技术讨论

### [提议向RISC-V B扩展指令集（bit操作扩展）添加选择（MUX）指令](https://groups.google.com/a/groups.riscv.org/forum/#!topic/isa-dev/TWo_avwkMkU)

Michael Clark提议向RISC-V B扩展指令集添加一条MUX指令：

    mux rd, rs1, rs2, rs3

完成选择（C语言 ` ? : ` 操作符）的功能：

    rd = rs1[0] ? rs2 : rs3

该提议的原因有几点：
- 用一般指令来完成相同功能需要4到5条指令。单挑指令会节省执行时间。
- 一般指令序列中需要使用跳转，跳转会造成不确定的指令执行时间，会造成执行时间和能耗变化，成为旁道攻击的目标。

反对的意见也很多：
- 如果允许源寄存器值被毁，选择操作可以通过合并两条压缩指令完成（C.BEQZ + C.MV）。
- 即使不确定的执行时间是主要问题，4到5条指令也可以做到恒定执行周期。
- 单个MUX指令需要3个寄存器读口，可能会造成流水线减速。
- 现在的32-bit指令放不下3个源寄存器地址，所以MUX需要使用48-bit指令，进一步降低其优势。

讨论中覆盖的其他问题（知识点）：
- 乱序流水线的处理器可以自动把MUX错做内部替换成CMOV(conditional move)条件执行指令，这基本是常用做法。
- RISC-V比较反对在基本指令集里面使用条件执行（Predicated execution）。条件执行将条件转化为数据依赖关系，需要扩展bypass网络和添加寄存器读口。
- 一般来说，条件执行只有在替换短于流水线长度（发生跳转时需要清除的流水线级数）的跳转下有速度优势。
- 用于加密解密的代码一般避免使用除法而用乘法。一般乘法由硬件实现，有恒定延时。
- 加解密算法会避免使用数据依赖的移位操作，目的也是恒定执行周期。

## 代码更新

### [Rocket-chip代码结构调整](https://github.com/freechipsproject/rocket-chip/pull/845)

Freechipsproject/rocket-chip经历了一次较大的结构调整。
其中包括:
- 拆分uncore，将所有子工程划入freechips.rocketchip工程包。
- 添加devices工程包。
- 继续移除历史遗留代码（ground test和原有配置逻辑）。
- 深化代码模块化和编译时模块化自动配置。
- 移除所有Tilelink代码。Tilelink2变成默认Tilelink。
- 继续移除所有L2配置。

> ([hcook](https://github.com/hcook))
>
> - Refactors package hierarchy to remove uncore and prepend freechips.rocketchip
> - Removes legacy ground tests and configs
> - Removes legacy bus protocol implementations
> - Removes NTiles
> - Adds devices package
> - Adds more functions to util package

### [修正一级缓存一致性错误](https://github.com/freechipsproject/rocket-chip/pull/849)

对称多处理(SMP)的Rocket-chip在运行Linux时会出现挂起错误，该错误可能是由于一级缓存在接到Probe请求（当二级缓存需要询问一级缓存相关缓存块状态时向一级缓存发送的询问请求）处理不当。该错误现在应该被纠正。

> ([aswaterman](https://github.com/aswaterman))
>
> - Handle TL errors in I$
> - Fix D$ probe bug
> - Add option for shared L2 TLB (disabled by default)

## 微群热点

### 众包RISC-V中文普及书

《步步惊芯》的作者雷思磊提出了撰写一本RISC-V中文普及书的建议并起草了提纲的草稿。

### RISC-V讨论群成立子群

## 行业视角
	
### [ARM vs RISC-V: A Game Theory perspective](https://www.design-reuse.com/industryexpertblogs/42335/arm-vs-risc-v-a-game-theory-perspective.html)

*Prakash Mohapatra, PraxThoughts, Jul. 07, 2017*

> "... I strongly believe in the democratic business model of ARM, in which all the stakeholders of the fabless ecosystem makes money. In my earlier blog posts, I have shared my insights on **why Intel, although having huge cash flow, failed to penetrate the smart phone SoC market. I believe the primary reason is that it was a competition between ARM’s ecosystem and Intel (with its vertically integrated business model).**
> 
> **Ecosystem enables network effects to take place, and it is difficult to challenge incumbents who hold important positions in the over-all value chain.** Currently, ARM occupies such a position in the embedded and IoT market. For RISC-V to challenge ARM, the former must create an extensive ecosystem around its ISA. With an open-source ISA, RISC-V has opened up the value-chain further by going one step back from ARM, which earns revenue from licensing its ISA. So, **RISC-V has more potential to create a symbiotic ecosystem**. ..."


## 市场动向


## 暴走事件

Do we want to keept these section here?

+ [OSDT开源开发工具大会2017](http://www.hellogcc.org/?p=34315)（也就是原HelloGCC会议）将在10月下旬在北京举办，话题和赞助征集已经开始。话题内容包括“面向RISCV等新硬件的基础软件支持”，各位不要错过。
+ [开源经济学研究-2017年年会邀请函](http://www.open-source-economics.org/open_source_economics_2017.html?from=groupmessage&isappinstalled=0&nsukey=cJ6MILUSOlQVLLra8gxd8Kt%2BDNp5mIECXwcJ3gefg408v8gu5cKkkYT3r%2B7HLHOmTdOFslmM7xNVLYNKEm9zA2dGX2Q4ig%2BPY7%2BfHhrvCa1nMXXih6lokOVzdtgmTWuvraTIrSpfGVBs18w47a86zGn86LB2hoXk7hWxgXq6Zvl5LivWz8xo5vuoBflx1v0w)
+ [FPGA Kongress](http://www.fpga-kongress.de/de/programm-2017), 11-13 July 2017 at the NH Hotel München-Dornach, Germany: The Case for implementing a soft RISC-V core in FPGA.
+ RISC-V at [HotChips](https://www.hotchips.org/), 20-22 August 2017 at Cupertino, California.
+ RISC-V at the [Linley Processor Conference](http://www.linleygroup.com/events/event.php?num=43), 4-5 October 2017 at Santa Clara, California.
+ [First Workshop on Computer Architecture Research with RISC-V (CARRV 2017)](https://carrv.github.io/#first-workshop-on-computer-architecture-research-with-risc-v-carrv-2017), 14 October at Boston, Massachusetts, co-located with MICRO 2017.


## 安全研究

自从2000年以来在x86和armv7/arm64硬件平台上GNU/Linux的攻防历史来看，[RISC-V是有机会借鉴x86和armv7/arm64的一些经验](https://github.com/hardenedlinux/embedded-iot_profile/blob/master/docs/riscv/riscv_security.md)。比如x86芯片以及芯片组对于RING 3( 对应RISC-V的User mode)的[NX](https://hardenedlinux.github.io/system-security/2016/06/01/NX-analysis.html)，RING 0( Supervisor mode)的[SMEP](https://github.com/hardenedlinux/grsecurity-101-tutorials/blob/master/kernel_mitigation.md#ret2usr-protection)，RING -1( Hypervisor/reserved/machine mode)的MBE以及RING -2( Machine mode)的SMRR。x86平台上的Linux内核一直以来安全问题都[没有得到改善](http://www.solidot.org/story?sid=52878)。这跟x86子系统是由Linus Torvalds本人维护有关，Linus认为性能更重要。虽然ARM子系统由ARM公司把控，推进安全上也相对较快，但依然没有很好的解决安全问题。这两大平台的历史教训都应该引起RISC-V的注意和警觉。今年4月份Don A. Bailey公开了一个由[内核Supervisor mode运行的程序映射一段代码进而任意执行Machine mode的代码的漏洞利用](http://blog.securitymouse.com/2017/04/the-risc-v-files-supervisor-machine.html)。该漏洞应该已经被最新的Privelege spec 1.10中的物理内存保护机制(PMP)修复。RISC-V仍然在快速发展中，在安全方面应该广泛参考以往处理器和操作系统的问题，仔细考量。


## 招聘信息

*发布一些群里发过红包的招聘，尽量剪短*
 
----

整理编集: 宋威，郭雄飞，黄柏玮

----

<a rel="license" href="http://creativecommons.org/licenses/by-sa/2.0/"><img alt="知识共享许可协议" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/2.0/88x31.png" /></a><br />本作品采用<a rel="license" href="http://creativecommons.org/licenses/by-sa/2.0/">知识共享署名-相同方式共享 2.0 通用许可协议</a>进行许可。
