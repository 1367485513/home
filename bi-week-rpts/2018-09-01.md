---
layout: default
---

# RISC-V 双周简报 (2018-09-01)

要点新闻：


## RV新闻


## 技术讨论

### 为什么RISC-V GCC (Linux)默认使用medlow代码模型

RISC-V现在有两个代码模型：medlow和medany。

- medlow: 对全局数据的寻址使用lui/ld的指令组合，程序被限制在[-2GB,2GB]的虚拟地址空间范围。
- medany: 对全局数据的寻址使用auipc/ld指令码组合，程序被限制在任意2GB的虚拟地址空间范围。

在这两种代码模型中，lui和auipc都是为了设置全局数据的[31:8]位的20位高址。
在medlow模型中，由于lui/ld的指令组合使用0x00000000为基址做32比特地址寻址，当局部出现的多个全局数据寻址，他们可共享同一个lui设定的高址。
在medany模型中，lui被替换为auipc，使用pc为基址。由于所有的全局寻址为基于pc的相对寻址，medany代码模型可以支持对任意地址空间的寻址，突破medlow的地址空间限制。
同时，medany可以支持加载时地址重定向，即地址无关代码(position independent code, PIC)的生成。

在Linux环境中，所有的程序都是运行在虚拟内存中，独占一个虚拟内存空间。当不需要加载时地址重定向的需求时(非动态加载库)，
使用medlow的lui/ld组合，GCC能够生成性能较优的代码，因而Linux上的RISC-V GCC默认使用medlow代码模型。
在编译动态加载库时，则需要手动使用medany代码模型。

为什么medany生成的代码性能比medlow差一些呢？
由于pc不是一个常量，对局部的多个全局数据寻址共享同一个auipc设定的高址可能会造成错误。
所以auipc/ld的指令组合并不能很好地被GCC优化，会产生大量的auipc指令。
此外，现有GCC编译器在`-O -mcmodel=medany -mexplicit-relocs`的参数组合下甚至会生成错误的代码。
在没有必要时，应当使用medlow模型，如果需要生成可重定向代码，现在暂时不要使用`-O -mcmodel=medany -mexplicit-relocs`的参数组合。

- sw-dev上的讨论
  [[1](https://groups.google.com/a/groups.riscv.org/d/msg/sw-dev/TEpsaiUwqh0/I945g_q-CQAJ)]
  [[2](https://groups.google.com/a/groups.riscv.org/d/msg/sw-dev/TEpsaiUwqh0/xkABDoHPCQAJ)]
  [[3](https://groups.google.com/a/groups.riscv.org/d/msg/sw-dev/TEpsaiUwqh0/Cp-H583RCQAJ)]


## 代码更新

### rocket-chip在repo中移除riscv-tools

过去由于RISC-V的工具链处于不断的变化之中，所以在rocket-chip中不得不包含对某个特定版本的`riscv-tools`的`git submoudle`链接。而最近的Pull Request显示，开发者正在将riscv-tools submodule移除，因为**工具链已经足够稳定，无需再指定特定工具链了**。

> The software ecosystem is now mostly stable. There are work-arounds to avoid bringing the giant riscv-tools into the tree for most projects using rocket. This PR makes their life easier.

Github PR: [https://git.io/fA3h0](https://github.com/freechipsproject/rocket-chip/pull/1601)

## 安全点评

## 微群热点

## 实用资料

### SiFive TileLink Specification 中文化资料
刘鹏同学正在翻译整理 **SiFive TileLink Specification** 文档，目前翻译了部分内容，后续内容会陆续放出。
待翻译完毕会重新进行整理校对，该文档主要是对于 **TileLink** 协议进行翻译与解释，重点讲述了 **TileLink** 中各通道内信号
传输规则，适合于初学者了解 **TileLink** 协议的特点，设计思想。翻译内容链接如下，英文原文档在下方。
 
- [翻译链接个人订阅号](https://mp.weixin.qq.com/s/fHyXJkzoAB8bb8rkj7oX3g)
- [SiFive TileLink Specification](https://static.dev.sifive.com/docs/tilelink/tilelink-sp)

### Fedora编译RISC-V Linux的脚本

Richard W.M. Jones在GitHub上完整公开了他编译Fedora RISC-V Linux的所有脚本。
对编译Linux平台bootstrap过程感兴趣的同学不要错过这个好工程。

- [fedora-riscv-bootstrap](https://github.com/rwmjones/fedora-riscv-bootstrap/)

## 行业视角

## 市场相关


## CNRV社区活动

## CNRV网站更新

## 会议征稿

## 暴走事件

### 2018年9月

- 2018年9月8日，Chisel/Rocket-chip/RISC-V线下交流会。[活动网站](https://www.bagevent.com/event/1770532)

### 2018年10月

- 2018年10月18日, RISC-V Day Tokyo将在Keio University举办，演讲征集已经开始。[注册网站](https://tmt.knect365.com/risc-v-day-tokyo/)

### 2018年12月

- 2018年11月13-14日 [Chisel Community Conference](https://chisel.eecs.berkeley.edu/blog/?p=200)将会在湾区举办，会议开放Call for Paper，地点还没有完全确定
- 2018年12月3-5日 [RISC-V Summit in Santa Clara (Dec. 3-5)](http://cts.businesswire.com/ct/CT?id=smartlink&url=https%3A%2F%2Ftmt.knect365.com%2Frisc-v-summit%2F&esheet=51792917&newsitemid=20180423005251&lan=en-US&anchor=RISC-V+Summit+in+Santa+Clara&index=4&md5=88ca965085b5b1b9b6ea996333f27e44)

## 招聘简讯

_CNRV提供为行业公司提供公益性质的一句话的招聘信息发布，若有任何体系结构、IC设计、软件开发的招聘信息，欢迎联系我们！_

----

整理编集: 宋威、黄柏玮、汪平、林容威、傅炜、巍巍、郭雄飞、黄玮

特别感谢: 刘鹏

----

**欢迎关注微信公众号CNRV，接收最新最时尚的RISC-V讯日, RISC-V Day Tokyo将在Keio University举办，演讲征集已经开始。[注册网站](https://tmt.knect365.com/risc-v-day-tokyo/)
息！**

![CNRV微信公众号](/assets/images/cnrv_qr.png)

----

<a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/cn/"><img alt="知识共享许可协议" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-sa/3.0/cn/80x15.png" /></a><br />本作品采用<a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/cn/">知识共享署名-非商业性使用-相同方式共享 3.0 中国大陆许可协议</a>进行许可。

