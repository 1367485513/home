---
layout: default
---

# RISC-V 双周简报 (2018-06-22)

要点新闻：

## RV新闻

## 技术讨论

### 为GNU编译器定义通用LP/SP（或者LX/SX）伪指令（RISC-V C API Documentation）

Palmer Dabbelt在sw-dev的邮件组提到他正在起草一个RISC-V C语言[API文档](https://github.com/riscv/riscv-c-api-doc/blob/master/riscv-c-api.md)。这个文档的目的是记录和维护各个RISC-V编译器（GCC，LLVM和其他商业编译器）的C语言API以方便查找。

这个讨论被Michael Clark转到了另外一个相关话题：为GNU Assembler (gas）编译器定义通用LP/SP（或者LX/SX）伪指令。在现有的的RISC-V汇编里，RV32模式使用LW指令从内存读取32位内容到寄存器（或者使用SW指令存储32位寄存器内容到内存）；在RV64模式下，相应的指令变成LD/SD指令（64位）。由于缺乏通用的伪指令，造成用户必须为RV32和RV64编写不同的汇编代码，非常的麻烦。Michael的提议是定义LP/SP（或者LX/SX）通用伪指令，这些指令在RV32下被编译器自动扩展成LW/SW；相应的，在RV64模式下被扩展成LD/SD。

这个提议得到Liviu Ionescu等人的大力响应，最后讨论的结果是使用LW/SX作为伪指令的命名。Jim Wilson会写一个patch来支持这个新功能。Palmer Dabbelt同时提议，应该加入如下的类似的功能：

  * 为浮点运算定义LF/SF指令：基于有无双精度浮点扩展（D Extension），这些指令被自动切换成FLW/FSW或者FLD/FSD。
  * 为指针定义LP/SP指令：基于ilp32或者lp64调用约定(calling convention)，这些指令被自动切换成LW/SW或者LD/SD。

Link: [sw-dev 上的讨论](https://groups.google.com/a/groups.riscv.org/forum/#!msg/sw-dev/zDctQe570AA/kTGIB5bKAgAJ)

### RISC-V如何支持big-endianness

最近有一位日本学者在邮件列表上询问，RISC-V如何能支持big-endianness，如果现在还没有支持，支持big-endianness有多困难？
结果，这个问题引出了一连串关于little/big-endianness的讨论。

首先，令小编吃惊的是，在日本，尽管99%的移动端、手机、多媒体、数据中心都使用little-endian模式，90%的工业和基础设施的应用都使用big-endian模式，比如说子弹头火车的控制、省级铁路系统、核电站控制等等。
日本政府和日立想使用RISC-V处理器来替代现有的PowerPC, SH, 68K和Coldfire处理器，但是支持big-endian显然成为了一个关键问题。

RISC-V原有的B指令集扩展本来是有支持little/big-endian数据转换指令的。但是随着B扩展指令集工作小组的解散，何时RISC-V能支持little/big-endian数据转换指令还不得而知。有人提出，我们为何不定义专门为big-endian数据访问的指令呢。
尽管这样的指令扩展会带来一定的性能提升，但是遭到了Ron Minnich (Google/Coreboot)和Andrew Waterman (SiFive)的极力反对。
通过双方的多轮讨论，最后得出的意见大概是：

- 如果更聪明地写代码，代码是可以写成endianness不敏感的，这样就不存在big-endian移植的问题。
- 实际生活中的程序并不是完美的代码，所以可能存在大量需要移植的代码，但是移植也只是需要数据转换指令，更多地big-endian指令其实没有实际作用。大部分的商用指令集也都只支持数据转换指令。
- RISC-V的指令集空间现在已经比较紧张，不太可能为big-endian去添加专门的big-endian数据读取指令，但是数据转换指令是一定会被加上的。
- 实际上，大部分的指令集都已经默认little-endian，尽管它们可能一开始是默认big-endian的。从ARMv7之后，ARM已经抛弃了little/big-endian双模的支持。
- 依赖编译器去直接编译big-endian代码到little-endian处理器运行是非常困难的。当年Intel ICC编译器为了支持Cisco big-endian程序的自动编译，一队工程师花了整整5年。

Link: [isa-dev上的讨论](https://groups.google.com/a/groups.riscv.org/d/msg/isa-dev/9tg4gGg8w-c/ADy-5lrHAgAJ)

### RVC到RV指令的扩展并非唯一

RISC-V的压缩指令集扩展RVC在定义时，规定每一条RVC指令都必须能等价翻译成一条RISC-V标准指令。
最近，Luke K. C. Leighton提问，为什么`C.MV r0, rs2`被翻译成`add r0, x0, rs2`而不是`addi, r0, rs2, 0`。
后者是标准指令集中对应的MV指令。也就是说，C.MV和MV被扩展成了不同的指令。
针对这个问题，Andrew回答，其实RVC指令到RV指令并不是唯一确定的，处理器实现可以根据自己的需要选择指令。
对应的RISC-V标准中对应RVC扩展的描述过于狭隘了，应该需要明确指出RVC到RV的映射并不唯一。

Link: [isa-dev上的讨论](https://groups.google.com/a/groups.riscv.org/d/msg/isa-dev/PlpKKLoYdg4/IRYh32oDBAAJ) 

## 代码更新

## 安全点评

## 微群热点

## 实用资料

## 行业视角

## 市场相关


## CNRV社区活动

## CNRV网站更新

## 会议征稿


## 暴走事件

### 六月

+ **RISC-V Day Shanghai, 2018年6月30日** [https://tmt.knect365.com/risc-v-day-shanghai/](https://tmt.knect365.com/risc-v-day-shanghai/)
+ 2018年7月1日下午，也就是RISC-V Day Shanghai的后一天会有HelloLLVM的线下聚会活动，地点在张江高科地铁站附近的传奇广场的Vπ咖啡，何不一波流来上海玩一把？

### 七月

- [RISC-V Workshop in Chennai (July 18-19)](http://cts.businesswire.com/ct/CT?id=smartlink&url=https%3A%2F%2Ftmt.knect365.com%2Frisc-v-workshop-india%2F&esheet=51792917&newsitemid=20180423005251&lan=en-US&anchor=RISC-V+Workshop+in+Chennai&index=3&md5=7988b5018298bbae9b8603d7779b3b4b)

### 十月

- RISC-V Day Tokyo (mid-October TBD)

### 十二月

- [RISC-V Summit in Santa Clara (Dec. 3-5)](http://cts.businesswire.com/ct/CT?id=smartlink&url=https%3A%2F%2Ftmt.knect365.com%2Frisc-v-summit%2F&esheet=51792917&newsitemid=20180423005251&lan=en-US&anchor=RISC-V+Summit+in+Santa+Clara&index=4&md5=88ca965085b5b1b9b6ea996333f27e44)


## 招聘简讯

_CNRV提供为行业公司提供公益性质的一句话的招聘信息发布，若有任何体系结构、IC设计、软件开发的招聘信息，欢迎联系我们！_

----

整理编集: 宋威、黄柏玮、汪平、林容威、傅炜、巍巍、郭雄飞、黄玮

----

**欢迎关注微信公众号CNRV，接收最新最时尚的RISC-V讯息！**

![CNRV微信公众号](/assets/images/cnrv_qr.png)

----

<a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/cn/"><img alt="知识共享许可协议" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-sa/3.0/cn/80x15.png" /></a><br />本作品采用<a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/cn/">知识共享署名-非商业性使用-相同方式共享 3.0 中国大陆许可协议</a>进行许可。

